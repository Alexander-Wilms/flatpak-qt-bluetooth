{
	"app-id": "com.github.btscanner",
	"runtime": "org.kde.Platform",
	"runtime-version": "5.9",
	"sdk": "org.kde.Sdk",
	"command": "btscanner",
	"finish-args":[
		"--socket=x11",
		"--share=ipc",
		"--device=all"
	],
	"modules":[
	{
			"name": "bluez",
			"config-opts": [ "--disable-datafiles", "--disable-systemd", "--enable-library", "--prefix=/app", "--sysconfdir=/app/etc" ],
			"sources": [
				{
					"type": "archive",
					"url": "http://www.kernel.org/pub/linux/bluetooth/bluez-5.47.tar.xz",
					"sha256": "cf75bf7cd5d564f21cc4a2bd01d5c39ce425397335fd47d9bbe43af0a58342c8"
				},
				{
				  "type": "shell",
				  "commands": ["sed -i \"s|\\${exec_prefix}|/app|g\" /app/share/pkgconfig/udev.pc"]
				}
			]
		},
        {
			"name": "qt5-connectivity",
			"buildsystem": "simple",
			"cleanup-platform": [ "/bin", "/mkspecs" ],
			"sources": [
				{
					"type": "git",
					"url": "git://code.qt.io/qt/qtconnectivity.git",
					"branch": "v5.9.1"
				}
			],
			"build-commands": [
					"qmake",
					"make",
					"cp -r -n bin /app",
					"cp -r -n include /app",
					"cp -r -n lib /app",
					"mkdir -p /app/src/bluetooth",
					"cp -r src/bluetooth /app/src/"
			]
		},
		{
			"name":"btscanner",
			"buildsystem": "simple",
			"sources":[
				{
					"type":"git",
					"url":"https://github.com/Alexander-Wilms/flatpak-qt-bluetooth"
				}
			],
			"build-commands": [
				"qmake PREFIX=/app btscanner.pro && \\
				make && \\
				make install && \\
				mkdir -p /app/share/icons/hicolor/48x48/apps && \\
				cp /usr/share/icons/breeze/apps/48/accessories-calculator.svg /app/share/icons/hicolor/48x48/apps/com.github.btscanner.svg && \\
				mkdir -p /app/share/appdata && \\
				cp /usr/share/appdata/org.kde.Sdk.appdata.xml /app/share/appdata/com.github.btscanner.appdata.xml"
			]
		}
    ]
}
